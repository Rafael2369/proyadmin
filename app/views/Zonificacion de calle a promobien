drop table #carga_zonas_promobien
CREATE TABLE #carga_zonas_promobien (Zona varchar(20),COLONIA varchar(100), cvecolonia varchar(20), ORDEN varchar(20), CP varchar(20))
insert into #carga_zonas_promobien
select DISTINCT NAME_ZON,COLONIA_OGE, CVECOLONIA_OGE, ORDEN_OGE, CP_OGE    
 from cc_orden_gestor     
 join cc_zone on IDZONE_ZON = IDZONA_OGE    
 join cc_state on IDSTATE_STA = IDSTATE_ZON    
 join cc_city on IDCITY_CIT = IDCITY_ZON    
 where sistema_zon = 1

 declare @linea int
	set @linea = (select max(id_oge) from cc_orden_gestor)

	delete from cc_orden_gestor
	where idzona_oge in (select idzone_zon from cc_zone where sistema_zon = 3 and name_zon in (select Zona from #carga_zonas_promobien))

	delete from cc_orden_actgestor
	where idzona_aog in (select idzone_zon from cc_zone where sistema_zon = 3 and name_zon in (select Zona from #carga_zonas_promobien))

	insert into cc_orden_gestor
	select idzone_zon, colonia, cvecolonia, orden, substring(cp, 0, len(cp)), 'FAMSA'
	from #carga_zonas_promobien
	join cc_zone on name_zon = zona and sistema_zon = 3
	order by idzone_zon, orden

	insert into cc_orden_actgestor
	select * from cc_orden_gestor
	where id_oge > @linea
	order by id_oge